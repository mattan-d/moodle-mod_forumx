!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):b(a.jQuery)}(this,function(a){"use strict";var b={},c=function(c,d){this.params={opened:!1,trigger:null,UL:null,maxIndex:0,closeOnClick:!1,focusOnOpen:!1},this.element=a(c),this.options=a.extend(!0,{},b,d),this.init(this)};c.prototype={init:function(a){a.params.closeOnClick="true"==a.element.attr("data-closeaction"),a.params.focusOnOpen="true"==a.element.attr("data-focusopen"),a.params.trigger=a.element.find("button:first"),a.params.UL=a.element.find("ul"),a.params.maxIndex=a.params.UL.children().length-1,a.setItems(),a.setEvents()},setItems:function(){this.params.UL.find("a").attr("role","menuitem")},setEvents:function(){var a=this;a.params.trigger.on("click",function(b){b.preventDefault(),b.stopPropagation(),a.toggleMenu()}),a.element.keydown(function(b){if(27==b.keyCode)a.params.opened=!1,a.openCloseMenu(!1),a.params.trigger.focus();else if(38==b.keyCode||40==b.keyCode){b.preventDefault(),b.stopPropagation();var c=38==b.keyCode?-1:1;a.moveFocus(c)}}),a.params.UL.find("a").on("click",function(){a.params.closeOnClick&&(a.params.opened=!1,a.openCloseMenu(!1),a.params.trigger.focus())})},toggleMenu:function(){this.params.opened=!this.params.opened,this.openCloseMenu(this.params.opened)},openCloseMenu:function(b){var c=this;c.params.trigger.attr("aria-expanded",b),c.params.UL.attr("aria-hidden",!b),b?(c.params.UL.addClass("show-menu"),c.params.focusOnOpen&&c.params.UL.find("a:first").focus(),a("html").on("click.simplemenu",function(b){c.hideIfOutside(a(b.target))}),a("html").on("focus.simplemenu","body",function(b){c.hideIfOutside(a(b.target))})):(c.params.UL.removeClass("show-menu"),a("html").off(".simplemenu"))},hideIfOutside:function(a){0==a.parents("#"+this.element[0].id).length&&(this.params.opened=!1,this.openCloseMenu(!1))},setFocus:function(a){this.params.UL.find("li:eq("+a+") a").focus()},moveFocus:function(a){if(0==this.params.maxIndex)return void this.setFocus(0);var b,c=this.params.UL.find(":focus").parent().index();-1==c?b=-1==a?this.params.maxIndex:0:(b=c+a,0>b?b=this.params.maxIndex:b>this.params.maxIndex&&(b=0)),this.setFocus(b)}},a.fn.ouilsimpleMenu=function(b){return this.each(function(){var d=a(this);d.data("ouilsimpleMenu",new c(d,b))})}});